import os
import datetime
#Input and Splitting File
file = open('File 1.txt', 'r').read()
file_arr = file.split('\n')
file = open('xml.txt', 'w')

file.write('<Dialogue date="2009-03-20" language="EN">')
file.write('\n')

t = datetime.time(12,52,51)
turns = 0

files = {}
conversations = {}
for line in file_arr:
	try:
		convo = line.split(':',1)
		turns = turns + 1
		time = str(t.hour)+':'+str(t.minute)+':'+str(t.second+turns)+' PM'
		conversations[convo[0]].append(convo[1])
		file.write('<turn mode="chat" speaker="'+convo[0]+'" end_time="'+time+'" turn_no="'+str(turns)+'" dialog_act="" comm_act_type="" link_to="" pos="" pos_count="" pos_origin="" topic="" polarity="">')
		files[convo[0]].write('<turn mode="chat" speaker="'+convo[0]+'" end_time="'+time+'" turn_no="'+str(turns)+'" dialog_act="" comm_act_type="" link_to="" pos="" pos_count="" pos_origin="" topic="" polarity="">')
		file.write(convo[1])
		files[convo[0]].write(convo[1])
		file.write('</turn>')
		files[convo[0]].write('</turn>')
		file.write('\n')
		files[convo[0]].write('\n')
	except KeyError as e:
		conversations[convo[0]] = []
		files[convo[0]] = open(convo[0]+'.txt', 'w')
		files[convo[0]].write('<Dialogue date="2009-03-20" language="EN">')
		files[convo[0]].write('\n')
		conversations[convo[0]].append(convo[1])
		
file.write('</Dialogue>')
for f in files.values():
	f.write('</Dialogue>')
